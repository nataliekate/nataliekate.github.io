<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.56 'Source Sans Pro',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.7);font-family:'Source Sans Pro',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;color:hsla(0,0%,0%,0.85);font-family:'Source Sans Pro',sans-serif;font-weight:200;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;color:hsla(0,0%,0%,0.85);font-family:'Source Sans Pro',sans-serif;font-weight:200;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;color:hsla(0,0%,0%,0.85);font-family:'Source Sans Pro',sans-serif;font-weight:200;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;color:hsla(0,0%,0%,0.85);font-family:'Source Sans Pro',sans-serif;font-weight:200;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;color:hsla(0,0%,0%,0.85);font-family:'Source Sans Pro',sans-serif;font-weight:200;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;color:hsla(0,0%,0%,0.85);font-family:'Source Sans Pro',sans-serif;font-weight:200;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}ul{margin-left:1.56rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.56rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;font-size:0.85rem;line-height:1.56rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;font-size:1rem;line-height:1.56rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}blockquote{margin-left:0;margin-right:1.56rem;margin-top:0;padding-bottom:0;padding-left:1.17rem;padding-right:0;padding-top:0;margin-bottom:1.56rem;font-size:1.20112rem;line-height:1.56rem;color:hsla(0,0%,0%,0.6);border-left:0.39rem solid hsla(0,0%,0%,0.13);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.56rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.56rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.56rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.56rem;margin-bottom:calc(1.56rem / 2);margin-top:calc(1.56rem / 2);}li > ul{margin-left:1.56rem;margin-bottom:calc(1.56rem / 2);margin-top:calc(1.56rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.56rem / 2);}code{font-size:0.85rem;line-height:1.56rem;}kbd{font-size:0.85rem;line-height:1.56rem;}samp{font-size:0.85rem;line-height:1.56rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.04rem;padding-right:1.04rem;padding-top:0.78rem;padding-bottom:calc(0.78rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:200;}a{font-weight:400;color:#419eda;text-decoration:none;}a:hover{color:#2a6496;text-decoration:underline;}@media only screen and (max-width:768px){html{font-size:100%;line-height:24.88px;}blockquote{margin-left:-1.17rem;margin-right:0;padding-left:0.78rem;}table{font-size:0.83255rem;line-height:1.56rem;}}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.a51c4fe18e18c396010b.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-4124805c0503dbfe42dd67d7f5715964.woff2) format("woff2"),url(/static/montserrat-latin-100-c8fb2f714bbc7bc3e8dfffa916b286dc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e4bf47bd171a9b2a72dd84c58bf90edf.woff2) format("woff2"),url(/static/montserrat-latin-100italic-d1f3f2d02ee4d7d2d4b1ad865014f189.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-444ae007121264bc1969d49b4031f9b2.woff2) format("woff2"),url(/static/montserrat-latin-200-edbce16a90aa22c297a0307b85789837.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-f316c5d1ec40f3e68654c3f38b3999f3.woff2) format("woff2"),url(/static/montserrat-latin-200italic-d7bbb730d9b5e11720b3eb32326dcca7.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-0a7c6df06e85d978d096d4d18fd8d43d.woff2) format("woff2"),url(/static/montserrat-latin-300-5e86df2cad22d2ef2b03516334afae5e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-c076c4892bc7a4be7b9097e97a35012d.woff2) format("woff2"),url(/static/montserrat-latin-300italic-37c74a8d2d0d36a0a2c6e9a37ee15b0c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-501ce09c42716a2f6e1503a25eb174c9.woff2) format("woff2"),url(/static/montserrat-latin-400-f29d2b8559699b6beb5b29b25b8bc572.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-882908d9950d9c86ebd380877f293d95.woff2) format("woff2"),url(/static/montserrat-latin-400italic-22e7b04e5f2a901d49d4d342315a715a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-f0f2716c5fe401d175b88715e7d28685.woff2) format("woff2"),url(/static/montserrat-latin-500-991b453bf90a0980e78966d2af7e3d3a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-4590ebba421b3288c305305d7fa7b504.woff2) format("woff2"),url(/static/montserrat-latin-500italic-f3d41e4cdcc2314e49ddcea751d6f87f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-15c24f7109941777774ddd2c636c6a50.woff2) format("woff2"),url(/static/montserrat-latin-600-f6dc6096f48956908c1787d9a722570a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-6d10b80529d5c36c7c09fca7193af0fc.woff2) format("woff2"),url(/static/montserrat-latin-600italic-02c4833312d94b1b0866f073023a250e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-79982cd1f74c6fa7451bf9b37ead09ff.woff2) format("woff2"),url(/static/montserrat-latin-700-957e93fbbe131a59791cd820d98b7109.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-283438e9577fe6a684466bb100e105ec.woff2) format("woff2"),url(/static/montserrat-latin-700italic-ca627c5ccc65cf80c2ecaea44b997de9.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-35386154b78d046218fc8f88a44ff515.woff2) format("woff2"),url(/static/montserrat-latin-800-756655905d91b77960888262e7d58d35.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-e1b52a7bd83e2324db6d92bdc206844c.woff2) format("woff2"),url(/static/montserrat-latin-800italic-a69f0add9d86c1a84311d7dd8693ba4a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-260c2ea3ef57feb82251952e605a36d5.woff2) format("woff2"),url(/static/montserrat-latin-900-186cae8091da578150d81958e217714a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-d785fb9fc74588ffb7f306799709a97d.woff2) format("woff2"),url(/static/montserrat-latin-900italic-43b527fe77254f97ea36e2b54e845ec4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#393a34;font-family:Monaco,Consolas,Courier New,Courier,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.95em;line-height:1.3em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:10px;background-color:rgba(0,0,0,.05)}:not(pre)>code[class*=language-]{padding:2px .3em;background:rgba(0,0,0,.05);border-radius:5px}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#998;font-style:italic}.token.namespace{opacity:.7}.token.attr-value,.token.string{color:#e3116c}.token.operator,.token.punctuation{color:#393a34}.token.boolean,.token.constant,.token.entity,.token.inserted,.token.number,.token.property,.token.regex,.token.symbol,.token.url,.token.variable{color:#36acaa}.language-autohotkey .token.selector,.token.atrule,.token.attr-name,.token.keyword{color:#00a4db}.language-autohotkey .token.tag,.token.deleted,.token.function{color:#8f09ef}.language-autohotkey .token.keyword,.token.selector,.token.tag{color:#00009f}.token.bold,.token.function,.token.important{font-weight:700}.token.italic{font-style:italic}</style><meta name="generator" content="Gatsby 2.7.3"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=5b7008ad49c9d7171a82dd27752f1d74"/><title data-react-helmet="true">Case Study：Google&#x27;s Santa Tracker | Natalie&#x27;s Blog</title><meta data-react-helmet="true" name="description" content="来源：Santa Tracker as a PWA去年圣诞节才知道Google弄了个有趣的小应用，叫Santa Tracker，让你实时跟踪圣诞老人的“去向”。当时就觉得太好玩了。今天无聊看了下Google Developers的前端Case Studies…"/><meta data-react-helmet="true" property="og:title" content="Case Study：Google&#x27;s Santa Tracker"/><meta data-react-helmet="true" property="og:description" content="来源：Santa Tracker as a PWA去年圣诞节才知道Google弄了个有趣的小应用，叫Santa Tracker，让你实时跟踪圣诞老人的“去向”。当时就觉得太好玩了。今天无聊看了下Google Developers的前端Case Studies…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="nataliekate"/><meta data-react-helmet="true" name="twitter:title" content="Case Study：Google&#x27;s Santa Tracker"/><meta data-react-helmet="true" name="twitter:description" content="来源：Santa Tracker as a PWA去年圣诞节才知道Google弄了个有趣的小应用，叫Santa Tracker，让你实时跟踪圣诞老人的“去向”。当时就觉得太好玩了。今天无聊看了下Google Developers的前端Case Studies…"/><link as="script" rel="preload" href="/webpack-runtime-e567695cd237f955e9ad.js"/><link as="script" rel="preload" href="/app-ccffa1967249b14ba1d0.js"/><link as="script" rel="preload" href="/styles-85de5ee0048996dd122c.js"/><link as="script" rel="preload" href="/0-3448555dcfa7c53d1e68.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-ac6d75cf8686c8adfe8d.js"/><link as="fetch" rel="preload" href="/static/d/871/path---googles-santa-tracker-1-d-0-653-E3lpF00a8vRqs8AqBFkptvtXU.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div style="margin-left:auto;margin-right:auto;max-width:39rem;padding:2.34rem 1.17rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Natalie&#x27;s Blog</a></h3></header><main><h1>Case Study：Google&#x27;s Santa Tracker</h1><p style="font-size:0.83255rem;line-height:1.56rem;display:block;margin-bottom:1.56rem;margin-top:-1.56rem">June 01, 2019</p><div><p>来源：<a href="https://developers.google.com/web/showcase/2017/santa">Santa Tracker as a PWA</a></p>
<p>去年圣诞节才知道Google弄了个有趣的小应用，叫Santa Tracker，让你实时跟踪圣诞老人的“去向”。当时就觉得太好玩了。今天无聊看了下Google Developers的前端Case Studies，发现刚好有一篇关于这个小应用的文章，于是读了一下，希望能汲取大神们的智慧。</p>
<p>Santa Tracker is an Progressive Web App (PWA) that supports Add to Home Screen (ATHS) and offline. The offline function makes use of the Service Worker API.</p>
<p>The unique ‘scenes’ on the web version of Santa Tracker is written in <a href="https://www.polymer-project.org/">Polymer 1.7.0</a>, supporting most modern browsers. The app requires ES6 features like <code class="language-text">Set</code> as well as the <strong>Web Performance API</strong>. To decide whether the browser is <em>modern</em> enough to run Santa Tracker, this <a href="https://github.com/google/santa-tracker-web/blob/280183e37e30f16856e9c238cc6de613f4309fd1/index.html#L75">code</a> will be executed.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> supported <span class="token operator">=</span> ignoreCheck <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// feature-detect APIs: limits to IE11+, SF9+</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>performance <span class="token operator">||</span> <span class="token operator">!</span>window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span>now <span class="token operator">||</span> <span class="token operator">!</span>window<span class="token punctuation">.</span>Set <span class="token operator">||</span> <span class="token operator">!</span>history<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// no older Android browser</span>
  <span class="token keyword">var</span> uaString <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>uaString<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'Chrome'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> uaString<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'Android'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token regex">/^Google/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>vendor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// no older Chromium (e.g., Samsung browser fork or ancient install)</span>
  <span class="token keyword">var</span> chromeVersion <span class="token operator">=</span> <span class="token regex">/Chrome\/(\d+)/</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>uaString<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>chromeVersion <span class="token operator">&amp;&amp;</span> chromeVersion<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>chromeVersion<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">44</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>supported<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// fail over to upgrade.html, falling back to timeout in case Analytics is failing.</span>
  <span class="token keyword">function</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'upgrade.html'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>query <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  window<span class="token punctuation">.</span><span class="token function">ga</span><span class="token punctuation">(</span><span class="token string">'send'</span><span class="token punctuation">,</span> <span class="token string">'pageview'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span><span class="token function">ga</span><span class="token punctuation">(</span><span class="token string">'send'</span><span class="token punctuation">,</span> <span class="token string">'event'</span><span class="token punctuation">,</span> <span class="token string">'Polymer'</span><span class="token punctuation">,</span> <span class="token string">'unsupported-browser'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> hitCallback<span class="token punctuation">:</span> redirect <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  navigator<span class="token punctuation">.</span>sendBeacon <span class="token operator">&amp;&amp;</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>redirect<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<br>
<h2><strong>Challenges</strong></h2>
<p>The size of the Santa Tracker app is rather large, like serveral hundred megabytes large! This is for a few reasons:</p>
<ul>
<li>Many assets must be duplicated in order to support multiple languages</li>
<li>Different media support for different platforms</li>
<li>Different sizes and resolutions for multimedia files</li>
</ul>
<p>In December, the app undergoes frequent updates, which means that <strong>assets already cached by a user’s browser may need to be refreshed on repeat visits.</strong> </p>
<h2><strong>Using Polymer</strong></h2>
<p><a href="https://github.com/google/santa-tracker-web/blob/master/bower.json#L25">Santa Tracker is now using <strong>Polymer 1.7</strong></a> (upgraded from 0.5), with a shared set of code including the router, shared navigation assets and so on.</p>
<p>Each scene uses a different URL and has its own web component. When a user opens a scene, all its required HTML and assets (images, audio, css, js) under <code class="language-text">/scenes/[[sceneName]]</code> are preloaded. Before the loading finishes, a friendly progress bar will show on the page.</p>
<p><img src="https://developers.google.com/web/showcase/2017/images/santa/preloader.gif" alt="Santa preloader"></p>
<p>An internal <a href="https://github.com/google/santa-tracker-web/blob/280183e37e30f16856e9c238cc6de613f4309fd1/gulp_scripts/file_manifest/index.js">“cache manifest”</a>, containing all the assets required for every scene, is needed to make the preloading work. This manifest is a JSON file storing a mapping from filename to an MD5 hash of its contents.</p>
<h3>Load what is used</h3>
<p>Santa Tracker leverages Polymer’s ability to upgrade custom elements at runtime, rather than at load time.</p>
<p>Santa Tracker uses <a href="https://github.com/google/santa-tracker-web/blob/280183e37e30f16856e9c238cc6de613f4309fd1/elements/santacontroller/santa-app.html#L74"><code class="language-text">&lt;lazy-pages&gt;</code></a> element to load a scene. The element resolves the scene’s element and <code class="language-text">path</code> attribute, loading the HTML import that contains the Polymer element and its dependent elements.</p>
<h2><strong>Offline Design with Service Worker</strong></h2>
<p>For Santa Tracker, the service worker is in <a href="https://github.com/google/santa-tracker-web/blob/280183e37e30f16856e9c238cc6de613f4309fd1/sw.js"><code class="language-text">sw.js</code></a>, which fires an <a href="https://github.com/google/santa-tracker-web/blob/280183e37e30f16856e9c238cc6de613f4309fd1/sw.js#L207"><code class="language-text">install</code> event</a> to precache all shared code, so nothing needs to be fetched at runtime.</p>
<p>The Service Worker, once installed, is able to intercept all HTTP requests. For Santa Tracker, the simplified decision flow looks like:</p>
<ol>
<li>
<p><strong>Is the request already cached?</strong></p>
<ul>
<li>Great! Return the cached response.  </li>
</ul>
</li>
<li>
<p><strong>Does the request match a scene directory, like “scenes/boatload/boatload-scene_en.html”?</strong></p>
<ul>
<li>Perform a network request, and store the result in the cache before returning it to the user.</li>
</ul>
</li>
<li><strong>Otherwise, perform a regular network request.</strong></li>
</ol>
<p>In this way, only the scenes a user has previously loaded will be available offline.</p>
<p>Every time a new release is deployed, all assets will have a different URL. That’s because each release generates an MD5 hash of every file and store this in the “cache manifest”. This means anything cached by the browser or service worker will be useless.</p>
<p>To solve this problem, in <code class="language-text">index.html</code> there is code to check for an updated service worker and fetch it. And then the browser will trigger the <code class="language-text">install</code> event again and <a href="https://github.com/google/santa-tracker-web/blob/master/sw.js#L176">compare the new “cache manifest” and the old one</a>. If assets have a different MD5 hash,the cached one will be deleted and the browser will refetch a new one.</p>
<p>Upgrading the service worker causes a user’s browser to <a href="https://github.com/google/santa-tracker-web/blob/master/index.html#L159">immediately reload</a>.</p>
<h3>Browsing offline</h3>
<p>The app sends regular requests to Santa’s API to check if the user is offline (request fail), instead of using <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/NavigatorOnLine/onLine"><code class="language-text">navigator.onLine</code></a>: this property depends on browser implementation, which may get false status of the network.</p>
<h3>Localization</h3>
<p>The app has versions for over 35 languages. Normally, <code class="language-text">Accept-Language</code> header and <a href="https://github.com/google/santa-tracker-web/blob/280183e37e30f16856e9c238cc6de613f4309fd1/sw.js#L31">other cues</a> are used to detect the language to serve. Otherwise, if a user manually choose a new language from the picker, a new version will be fetched. In other words, the version of Santa Tracker is in face a tuple of (build, language).</p></div><hr style="margin-bottom:1.56rem"/><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;margin:3.12rem 0 3.12rem 0"><li><a rel="prev" href="/parseInt/">← <!-- -->Tricky parseInt()</a></li><li></li></ul></main><footer>© <!-- -->2019<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a>, by Natalie</footer></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"googles-santa-tracker-1d0","path":"/googles-santa-tracker/"};window.dataPath="871/path---googles-santa-tracker-1-d-0-653-E3lpF00a8vRqs8AqBFkptvtXU";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-ccffa1967249b14ba1d0.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-7ade3efd7b4848cc33a1.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-ac6d75cf8686c8adfe8d.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e27e3358a398d92bedcd.js"],"component---src-pages-index-js":["/component---src-pages-index-js-90879524e856dc9243ab.js"],"pages-manifest":["/pages-manifest-79b55fa8e8c66e67a9fa.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-ac6d75cf8686c8adfe8d.js" async=""></script><script src="/0-3448555dcfa7c53d1e68.js" async=""></script><script src="/styles-85de5ee0048996dd122c.js" async=""></script><script src="/app-ccffa1967249b14ba1d0.js" async=""></script><script src="/webpack-runtime-e567695cd237f955e9ad.js" async=""></script></body></html>